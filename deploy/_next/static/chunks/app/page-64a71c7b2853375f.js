(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{19619:(e,t,s)=>{Promise.resolve().then(s.bind(s,89048))},89048:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>M});var a=s(95155),n=s(12115),r=s(35695);let i={ai:{defaultModel:"moonshotai/kimi-k2-instruct",availableModels:["openai/gpt-5","moonshotai/kimi-k2-instruct","anthropic/claude-sonnet-4-20250514","google/gemini-2.5-pro"],modelDisplayNames:{"openai/gpt-5":"GPT-5","moonshotai/kimi-k2-instruct":"Kimi K2 Instruct","anthropic/claude-sonnet-4-20250514":"Sonnet 4","google/gemini-2.5-pro":"Gemini 2.5 Pro"},defaultTemperature:.7,maxTokens:8e3,truncationRecoveryMaxTokens:4e3},codeApplication:{defaultRefreshDelay:2e3,packageInstallRefreshDelay:5e3,enableTruncationRecovery:!1,maxTruncationRecoveryAttempts:1}};var l=s(54624),o=s(74466),c=s(52596),d=s(39688);function p(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,d.QP)((0,c.$)(t))}let m=(0,o.F)("inline-flex items-center justify-center whitespace-nowrap rounded-medium text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-95",{variants:{variant:{default:"bg-gradient-primary text-primary-foreground hover:shadow-glow-primary hover:scale-105 shadow-medium",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 hover:shadow-glow-destructive",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground hover:shadow-soft",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 hover:shadow-soft",ghost:"hover:bg-accent hover:text-accent-foreground hover:shadow-soft",link:"text-primary underline-offset-4 hover:underline",success:"bg-success text-success-foreground hover:bg-success/90 hover:shadow-glow-success",warning:"bg-warning text-warning-foreground hover:bg-warning/90 hover:shadow-glow-warning",info:"bg-info text-info-foreground hover:bg-info/90 hover:shadow-glow",glass:"glass text-foreground hover:bg-opacity-20 hover:shadow-medium",gradient:"bg-gradient-mesh text-white hover:shadow-strong hover:scale-105"},size:{default:"h-11 px-6 py-3",sm:"h-9 rounded-md px-3",lg:"h-12 rounded-lg px-8",xl:"h-14 rounded-xl px-10 text-base",icon:"h-10 w-10","icon-sm":"h-8 w-8","icon-lg":"h-12 w-12"},animation:{none:"",bounce:"animate-bounce-gentle",pulse:"animate-pulse",shimmer:"animate-shimmer",scale:"hover:scale-105 active:scale-95",slide:"animate-slide-in-right"}},defaultVariants:{variant:"default",size:"default",animation:"scale"}}),x=n.forwardRef((e,t)=>{let{className:s,variant:n,size:r,animation:i,loading:o,leftIcon:c,rightIcon:d,children:x,disabled:u,...h}=e,g=h.asChild?l.DX:"button";return(0,a.jsxs)(g,{className:p(m({variant:n,size:r,animation:i,className:s})),ref:t,disabled:u||o,...h,children:[o&&(0,a.jsx)("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),!o&&c&&(0,a.jsx)("span",{className:"mr-2",children:c}),x,!o&&d&&(0,a.jsx)("span",{className:"ml-2",children:d})]})});x.displayName="Button";let u=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("textarea",{className:p("flex min-h-[80px] w-full rounded-[10px] border border-zinc-300 bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [box-shadow:inset_0px_-2px_0px_0px_#e4e4e7,_0px_1px_6px_0px_rgba(228,_228,_231,_30%)] hover:[box-shadow:inset_0px_-2px_0px_0px_#d4d4d8,_0px_1px_6px_0px_rgba(212,_212,_216,_40%)] focus-visible:[box-shadow:inset_0px_-2px_0px_0px_#f97316,_0px_1px_6px_0px_rgba(249,_115,_22,_30%)] transition-all duration-200",s),ref:t,...n})});u.displayName="Textarea";var h=s(58497),g=s(38391),f=s(15305),b=s(10351),v=s(59432),y=s(38274),w=s(60760);function j(e){let{state:t}=e;return t.stage&&"complete"!==t.stage?(0,a.jsx)(w.N,{mode:"wait",children:(0,a.jsx)(y.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"inline-block bg-gray-100 rounded-[10px] p-3 mt-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(y.P.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-4 h-4",children:(0,a.jsx)("svg",{className:"w-full h-full",viewBox:"0 0 24 24",fill:"none",children:(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"31.416",strokeDashoffset:"10",className:"text-gray-700"})})}),(0,a.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Applying to sandbox..."})]})},"loading")}):null}let N=n.forwardRef((e,t)=>{let{className:s,type:n,...r}=e;return(0,a.jsx)("input",{type:n,className:p("flex h-10 w-full rounded-[10px] border border-zinc-300 bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [box-shadow:inset_0px_-2px_0px_0px_#e4e4e7,_0px_1px_6px_0px_rgba(228,_228,_231,_30%)] hover:[box-shadow:inset_0px_-2px_0px_0px_#d4d4d8,_0px_1px_6px_0px_rgba(212,_212,_216,_40%)] focus-visible:[box-shadow:inset_0px_-2px_0px_0px_#f97316,_0px_1px_6px_0px_rgba(249,_115,_22,_30%)] transition-all duration-200",s),ref:t,...r})});N.displayName="Input";let k=(0,o.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),_=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("label",{ref:t,className:p(k(),s),...n})});_.displayName="Label";let C=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:p("card-modern",s),...n})});C.displayName="Card";let I=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:p("flex flex-col space-y-1.5 p-6",s),...n})});I.displayName="CardHeader";let E=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("h3",{ref:t,className:p("text-2xl font-semibold leading-none tracking-tight text-foreground",s),...n})});E.displayName="CardTitle";let S=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("p",{ref:t,className:p("text-sm text-muted-foreground",s),...n})});S.displayName="CardDescription";let P=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:p("p-6 pt-0",s),...n})});P.displayName="CardContent",n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:p("flex items-center p-6 pt-0",s),...n})}).displayName="CardFooter";let A={E2B_API_KEY:"",FIRECRAWL_API_KEY:"",ANTHROPIC_API_KEY:"",OPENAI_API_KEY:"",GEMINI_API_KEY:"",GROQ_API_KEY:""};function L(){try{let e=localStorage.getItem("apiKeys");if(e){let t=JSON.parse(e);return{...A,...t}}}catch(e){console.error("Failed to parse saved API keys:",e)}return A}function F(e){let t=L()[e];return"string"==typeof t&&t.length>0&&!t.startsWith("your_")&&!t.includes("your_")}function T(){return F("E2B_API_KEY")&&F("FIRECRAWL_API_KEY")}function G(e){let{isOpen:t,onClose:s}=e,[r,i]=(0,n.useState)({E2B_API_KEY:"",FIRECRAWL_API_KEY:"",ANTHROPIC_API_KEY:"",OPENAI_API_KEY:"",GEMINI_API_KEY:"",GROQ_API_KEY:""}),[l,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)("idle");(0,n.useEffect)(()=>{t&&i(L())},[t]);let p=(e,t)=>{i(s=>({...s,[e]:t}))},m=async()=>{o(!0),d("saving");try{try{let e={...L(),...r};localStorage.setItem("apiKeys",JSON.stringify(e))}catch(e){console.error("Failed to save API keys:",e)}await new Promise(e=>setTimeout(e,1e3)),d("saved"),setTimeout(()=>d("idle"),2e3)}catch(e){console.error("Failed to save API keys:",e),d("error"),setTimeout(()=>d("idle"),3e3)}finally{o(!1)}},u=e=>{let t=r[e];return t?t.startsWith("your_")||t.includes("your_")?"placeholder":"configured":"missing"},h=e=>{switch(e){case"configured":return"text-green-600";case"placeholder":return"text-yellow-600";case"missing":return"text-red-600";default:return"text-gray-600"}},g=e=>{switch(e){case"configured":return"✓ Configured";case"placeholder":return"⚠ Placeholder";case"missing":return"✗ Missing";default:return"Unknown"}};return t?(0,a.jsx)(w.N,{children:(0,a.jsx)(y.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:s,children:(0,a.jsx)(y.P.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:(0,a.jsxs)(C,{className:"border-0 shadow-none",children:[(0,a.jsx)(I,{className:"pb-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(E,{className:"text-2xl font-bold",children:"Settings"}),(0,a.jsx)(S,{children:"Configure your API keys for AI services and tools"})]}),(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:s,className:"h-8 w-8 p-0",children:"✕"})]})}),(0,a.jsxs)(P,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-600 dark:text-red-400",children:"Required API Keys"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(_,{htmlFor:"E2B_API_KEY",className:"flex items-center gap-2",children:["E2B API Key",(0,a.jsx)("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded-full",children:"Required"})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,a.jsx)(N,{id:"E2B_API_KEY",type:"password",placeholder:"Get from https://e2b.dev (Sandboxes)",value:r.E2B_API_KEY,onChange:e=>p("E2B_API_KEY",e.target.value),className:"flex-1"}),(0,a.jsxs)(x,{variant:"outline",size:"sm",onClick:()=>window.open("https://e2b.dev","_blank"),className:"px-3 py-2 text-xs whitespace-nowrap",title:"Go to E2B website",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Get Key"]}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(h(u("E2B_API_KEY"))),children:g(u("E2B_API_KEY"))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(_,{htmlFor:"FIRECRAWL_API_KEY",className:"flex items-center gap-2",children:["Firecrawl API Key",(0,a.jsx)("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded-full",children:"Required"})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,a.jsx)(N,{id:"FIRECRAWL_API_KEY",type:"password",placeholder:"Get from https://firecrawl.dev (Web scraping)",value:r.FIRECRAWL_API_KEY,onChange:e=>p("FIRECRAWL_API_KEY",e.target.value),className:"flex-1"}),(0,a.jsxs)(x,{variant:"outline",size:"sm",onClick:()=>window.open("https://firecrawl.dev","_blank"),className:"px-3 py-2 text-xs whitespace-nowrap",title:"Go to Firecrawl website",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Get Key"]}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(h(u("FIRECRAWL_API_KEY"))),children:g(u("FIRECRAWL_API_KEY"))})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-blue-600 dark:text-blue-400",children:"AI Provider API Keys (Optional - Need at least one)"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(_,{htmlFor:"ANTHROPIC_API_KEY",children:"Anthropic API Key"}),(0,a.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,a.jsx)(N,{id:"ANTHROPIC_API_KEY",type:"password",placeholder:"Get from https://console.anthropic.com",value:r.ANTHROPIC_API_KEY,onChange:e=>p("ANTHROPIC_API_KEY",e.target.value),className:"flex-1"}),(0,a.jsxs)(x,{variant:"outline",size:"sm",onClick:()=>window.open("https://console.anthropic.com","_blank"),className:"px-3 py-2 text-xs whitespace-nowrap",title:"Go to Anthropic console",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Get Key"]}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(h(u("ANTHROPIC_API_KEY"))),children:g(u("ANTHROPIC_API_KEY"))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(_,{htmlFor:"OPENAI_API_KEY",children:"OpenAI API Key"}),(0,a.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,a.jsx)(N,{id:"OPENAI_API_KEY",type:"password",placeholder:"Get from https://platform.openai.com (GPT-5)",value:r.OPENAI_API_KEY,onChange:e=>p("OPENAI_API_KEY",e.target.value),className:"flex-1"}),(0,a.jsxs)(x,{variant:"outline",size:"sm",onClick:()=>window.open("https://platform.openai.com","_blank"),className:"px-3 py-2 text-xs whitespace-nowrap",title:"Go to OpenAI platform",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Get Key"]}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(h(u("OPENAI_API_KEY"))),children:g(u("OPENAI_API_KEY"))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(_,{htmlFor:"GEMINI_API_KEY",children:"Gemini API Key"}),(0,a.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,a.jsx)(N,{id:"GEMINI_API_KEY",type:"password",placeholder:"Get from https://aistudio.google.com/app/apikey",value:r.GEMINI_API_KEY,onChange:e=>p("GEMINI_API_KEY",e.target.value),className:"flex-1"}),(0,a.jsxs)(x,{variant:"outline",size:"sm",onClick:()=>window.open("https://aistudio.google.com/app/apikey","_blank"),className:"px-3 py-2 text-xs whitespace-nowrap",title:"Go to Google AI Studio",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Get Key"]}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(h(u("GEMINI_API_KEY"))),children:g(u("GEMINI_API_KEY"))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(_,{htmlFor:"GROQ_API_KEY",children:"Groq API Key"}),(0,a.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,a.jsx)(N,{id:"GROQ_API_KEY",type:"password",placeholder:"Get from https://console.groq.com (Fast inference - Kimi K2 recommended)",value:r.GROQ_API_KEY,onChange:e=>p("GROQ_API_KEY",e.target.value),className:"flex-1"}),(0,a.jsxs)(x,{variant:"outline",size:"sm",onClick:()=>window.open("https://console.groq.com","_blank"),className:"px-2 py-2 text-xs whitespace-nowrap",title:"Go to Groq console",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Get Key"]}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(h(u("GROQ_API_KEY"))),children:g(u("GROQ_API_KEY"))})]})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4 border-t",children:[(0,a.jsx)(x,{onClick:m,disabled:l,className:"flex-1",children:l?"Saving...":"Save Settings"}),(0,a.jsx)(x,{variant:"outline",onClick:()=>{i({E2B_API_KEY:"",FIRECRAWL_API_KEY:"",ANTHROPIC_API_KEY:"",OPENAI_API_KEY:"",GEMINI_API_KEY:"",GROQ_API_KEY:""});try{localStorage.removeItem("apiKeys")}catch(e){console.error("Failed to clear API keys:",e)}},disabled:l,children:"Reset"}),(0,a.jsx)(x,{variant:"ghost",onClick:s,disabled:l,children:"Cancel"})]}),"idle"!==c&&(0,a.jsxs)(y.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-center p-3 rounded-lg ".concat("saved"===c?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"error"===c?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"),children:["saving"===c&&"Saving settings...","saved"===c&&"Settings saved successfully! ✓","error"===c&&"Failed to save settings. Please try again."]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-2",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Note:"})," API keys are stored locally in your browser and are not sent to our servers."]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Required:"})," E2B and Firecrawl API keys are needed for sandbox and web scraping functionality."]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"AI Providers:"})," At least one AI provider API key is recommended for code generation features."]})]})]})]})})})}):null}function R(){let[e,t]=(0,n.useState)(null),[s,r]=(0,n.useState)(!1),[i,l]=(0,n.useState)(!1),[o,c]=(0,n.useState)(!1);(0,n.useEffect)(()=>{"serviceWorker"in navigator&&d();let e=e=>{e.preventDefault(),t(e),r(!0)},s=()=>{l(!0),r(!1),t(null)};window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",s);let a=window.matchMedia("(display-mode: standalone)").matches,n=window.matchMedia("(display-mode: fullscreen)").matches,i=window.matchMedia("(display-mode: minimal-ui)").matches;return(a||n||i)&&l(!0),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",s)}},[]);let d=async()=>{try{let e=await navigator.serviceWorker.register("/sw.js",{scope:"/"});console.log("[PWA] Service Worker registered:",e),e.addEventListener("updatefound",()=>{let t=e.installing;t&&t.addEventListener("statechange",()=>{"installed"===t.state&&navigator.serviceWorker.controller&&c(!0)})}),setInterval(()=>{e.update()},6e4)}catch(e){console.error("[PWA] Service Worker registration failed:",e)}},p=async()=>{if(e)try{await e.prompt();let{outcome:s}=await e.userChoice;"accepted"===s?(console.log("[PWA] User accepted the install prompt"),r(!1)):console.log("[PWA] User dismissed the install prompt"),t(null)}catch(e){console.error("[PWA] Install prompt failed:",e)}},m=()=>{r(!1),localStorage.setItem("pwa-install-dismissed",Date.now().toString())};return(0,n.useEffect)(()=>{let e=localStorage.getItem("pwa-install-dismissed");if(e){let t=parseInt(e);Date.now()-t<864e5&&r(!1)}},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w.N,{children:s&&!i&&(0,a.jsx)(y.P.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:max-w-sm bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg p-4 z-50",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Install Open Lovable"}),(0,a.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Install our app for a better experience with offline support and faster loading."}),(0,a.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,a.jsx)(x,{size:"sm",onClick:p,className:"text-xs",children:"Install"}),(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:m,className:"text-xs",children:"Not now"})]})]}),(0,a.jsx)("button",{onClick:m,className:"flex-shrink-0 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})}),(0,a.jsx)(w.N,{children:o&&(0,a.jsx)(y.P.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:"fixed top-4 left-4 right-4 md:left-auto md:right-4 md:max-w-sm bg-green-50 dark:bg-green-900 border border-green-200 dark:border-green-700 rounded-lg shadow-lg p-4 z-50",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"w-6 h-6 text-green-600 dark:text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-green-900 dark:text-green-100",children:"Update Available"}),(0,a.jsx)("p",{className:"text-xs text-green-700 dark:text-green-300 mt-1",children:"A new version is available. Refresh to get the latest features."}),(0,a.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,a.jsx)(x,{size:"sm",onClick:()=>{"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.waiting&&(e.waiting.postMessage({type:"SKIP_WAITING"}),window.location.reload())})},className:"text-xs bg-green-600 hover:bg-green-700 text-white",children:"Update Now"}),(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>c(!1),className:"text-xs text-green-700 dark:text-green-300",children:"Later"})]})]}),(0,a.jsx)("button",{onClick:()=>c(!1),className:"flex-shrink-0 text-green-400 hover:text-green-600 dark:hover:text-green-300",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})}),!1]})}function K(){let[e,t]=(0,n.useState)(!0),[s,r]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{t(navigator.onLine);let e=()=>{t(!0),r(!1)},s=()=>{t(!1),r(!0)};return window.addEventListener("online",e),window.addEventListener("offline",s),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}},[]),(0,n.useEffect)(()=>{if(e&&s){let e=setTimeout(()=>{r(!1)},3e3);return()=>clearTimeout(e)}},[e,s]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w.N,{children:!e&&(0,a.jsx)(y.P.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:"fixed top-0 left-0 right-0 bg-yellow-500 text-white px-4 py-2 z-50 shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"You're offline. Some features may not be available."})]})})}),(0,a.jsx)(w.N,{children:e&&s&&(0,a.jsx)(y.P.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:"fixed top-0 left-0 right-0 bg-green-500 text-white px-4 py-2 z-50 shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"You're back online!"})]})})}),!1]})}function M(){let[e,t]=(0,n.useState)(null),[s,l]=(0,n.useState)(!1),[o,c]=(0,n.useState)({text:"Not connected",active:!1}),[d,p]=(0,n.useState)([]),[m,w]=(0,n.useState)("No sandbox created yet"),[N,k]=(0,n.useState)(""),[_,C]=(0,n.useState)([{content:'Welcome! I can help you generate code with full context of your sandbox files and structure. Just start chatting - I\'ll automatically create a sandbox for you if needed!\n\nTip: If you see package errors like "react-router-dom not found", just type "npm install" or "check packages" to automatically install missing packages.',type:"system",timestamp:new Date}]),[I,E]=(0,n.useState)(""),[S]=(0,n.useState)(!0),P=(0,r.useRouter)(),[A,L]=(0,n.useState)(()=>i.ai.availableModels.includes("")?null:i.ai.defaultModel),[F,M]=(0,n.useState)(!1),[O,W]=(0,n.useState)(""),[z,D]=(0,n.useState)([]),[Y,B]=(0,n.useState)(!0),[U,H]=(0,n.useState)(new Set(["app","src","src/components"])),[J,q]=(0,n.useState)(null),[Q,V]=(0,n.useState)(!1),[Z,$]=(0,n.useState)(""),[X,ee]=(0,n.useState)(""),[et,es]=(0,n.useState)("preview"),[ea,en]=(0,n.useState)(!1),[er,ei]=(0,n.useState)(null),[el,eo]=(0,n.useState)(!1),[ec,ed]=(0,n.useState)(null),[ep,em]=(0,n.useState)(!1),[ex,eu]=(0,n.useState)(null),[eh,eg]=(0,n.useState)(!1),[ef,eb]=(0,n.useState)(""),[ev,ey]=(0,n.useState)(null),[ew,ej]=(0,n.useState)({}),[eN,ek]=(0,n.useState)(""),[e_,eC]=(0,n.useState)(!1),[eI,eE]=(0,n.useState)({scrapedWebsites:[],generatedComponents:[],appliedCode:[],currentProject:"",lastGeneratedCode:void 0}),eS=(0,n.useRef)(null),eP=(0,n.useRef)(null),eA=(0,n.useRef)(null),[eL,eF]=(0,n.useState)({stage:null}),[eT,eG]=(0,n.useState)({isGenerating:!1,status:"",components:[],currentComponent:0,streamedCode:"",isStreaming:!1,isThinking:!1,files:[],lastProcessedPosition:0});(0,n.useEffect)(()=>{let e=!0;return(async()=>{try{await fetch("/api/conversation-state",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"clear-old"})}),console.log("[home] Cleared old conversation data on mount")}catch(t){console.error("[ai-sandbox] Failed to clear old conversation:",t),e&&eM("Failed to clear old conversation data.","error")}if(e){l(!0);try{console.log("[home] No sandbox in URL, creating new sandbox automatically..."),await ez(!0)}catch(t){console.error("[ai-sandbox] Failed to create or restore sandbox:",t),e&&eM("Failed to create or restore sandbox.","error")}finally{e&&l(!1)}}})(),()=>{e=!1}},[]),(0,n.useEffect)(()=>{let e=e=>{"Escape"===e.key&&Y&&(V(!0),setTimeout(()=>{B(!1),V(!1)},500))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[Y]),(0,n.useEffect)(()=>{if(!Y&&Z&&!ec&&!ep){let e=Z.trim();e.match(/^https?:\/\//i)||(e="https://"+e),eZ(e)}},[Y,Z]),(0,n.useEffect)(()=>{eW();let e=()=>{eW()};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[]),(0,n.useEffect)(()=>{eP.current&&(eP.current.scrollTop=eP.current.scrollHeight)},[_]);let eR=(e,t)=>{c({text:e,active:t})},eK=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";p(s=>[...s,"[".concat(t,"] ").concat(e)])},eM=(e,t,s)=>{C(a=>{if("system"===t&&a.length>0){let t=a[a.length-1];if("system"===t.type&&t.content===e)return a}return[...a,{content:e,type:t,timestamp:new Date,metadata:s}]})},eO=async()=>{if(!e)return void eM("No active sandbox. Create a sandbox first!","system");eM("Sandbox is ready. Vite configuration is handled by the template.","system")},eW=async()=>{try{let e=await fetch("/api/sandbox-status"),s=await e.json();s.active&&s.healthy&&s.sandboxData?(t(s.sandboxData),eR("Sandbox active",!0)):s.active&&!s.healthy?eR("Sandbox not responding",!1):(t(null),eR("No sandbox",!1))}catch(e){console.error("Failed to check sandbox status:",e),t(null),eR("Error",!1)}},ez=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];console.log("[createSandbox] Starting sandbox creation..."),l(!0),eo(!0),eR("Creating sandbox...",!1),p([]),eu(null);try{let s=await fetch("/api/create-ai-sandbox",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),a=await s.json();if(console.log("[createSandbox] Response data:",a),a.success){t(a),eR("Sandbox active",!0),eK("Sandbox created successfully!"),eK("Sandbox ID: ".concat(a.sandboxId)),eK("URL: ".concat(a.url));let s=new URLSearchParams(window.location.search);s.set("sandbox",a.sandboxId),s.set("model",A),P.push("/?".concat(s.toString()),{scroll:!1}),setTimeout(()=>{eo(!1)},3e3),a.structure&&eD(a.structure),setTimeout(eB,1e3),setTimeout(async()=>{try{console.log("[createSandbox] Ensuring Vite server is running...");let e=await fetch("/api/restart-vite",{method:"POST",headers:{"Content-Type":"application/json"}});e.ok&&(await e.json()).success&&console.log("[createSandbox] Vite server started successfully")}catch(e){console.error("[createSandbox] Error starting Vite server:",e)}},2e3),e||eM("Sandbox created! ID: ".concat(a.sandboxId,". I now have context of your sandbox and can help you build your app. Just ask me to create components and I'll automatically apply them!\n\nTip: I automatically detect and install npm packages from your code imports (like react-router-dom, axios, etc.)"),"system"),setTimeout(()=>{eS.current&&(eS.current.src=a.url)},100)}else throw Error(a.error||"Unknown error")}catch(e){console.error("[createSandbox] Error:",e),eR("Error",!1),eK("Failed to create sandbox: ".concat(e.message),"error"),eM("Failed to create sandbox: ".concat(e.message),"system")}finally{l(!1)}},eD=e=>{"object"==typeof e?w(JSON.stringify(e,null,2)):w(e||"No structure available")},eY=async function(t){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];l(!0),eK("Applying AI-generated code...");try{var a,n,r,o,c,d,p,m,x,u,h,g;eF({stage:"analyzing"});let l=(window.pendingPackages||[]).filter(e=>e&&"string"==typeof e);l.length>0&&(console.log("[applyGeneratedCode] Sending packages from tool calls:",l),window.pendingPackages=[]);let f=await fetch("/api/apply-ai-code-stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({response:t,isEdit:s,packages:l,sandboxId:null==e?void 0:e.sandboxId})});if(!f.ok)throw Error("Failed to apply code: ".concat(f.statusText));let b=null==(a=f.body)?void 0:a.getReader(),v=new TextDecoder,y=null;for(;b;){let{done:e,value:t}=await b.read();if(e)break;for(let e of v.decode(t).split("\n"))if(e.startsWith("data: "))try{let t=JSON.parse(e.slice(6));switch(t.type){case"start":eF({stage:"analyzing"});break;case"step":t.message.includes("Installing")&&t.packages?eF({stage:"installing",packages:t.packages}):(t.message.includes("Creating files")||t.message.includes("Applying"))&&eF({stage:"applying",filesGenerated:[]});break;case"package-progress":t.installedPackages&&eF(e=>({...e,installedPackages:t.installedPackages}));break;case"command":t.command&&!t.command.includes("npm install")&&eM(t.command,"command",{commandType:"input"});break;case"success":t.installedPackages&&eF(e=>({...e,installedPackages:t.installedPackages}));break;case"file-progress":case"file-complete":break;case"command-progress":eM("".concat(t.action," command: ").concat(t.command),"command",{commandType:"input"});break;case"command-output":eM(t.output,"command",{commandType:"stderr"===t.stream?"error":"output"});break;case"command-complete":t.success?eM("Command completed successfully","system"):eM("Command failed with exit code ".concat(t.exitCode),"system");break;case"complete":y=t,eF({stage:"complete"}),setTimeout(()=>{eF({stage:null})},3e3);break;case"error":eM("Error: ".concat(t.message||t.error||"Unknown error"),"system");break;case"warning":eM("".concat(t.message),"system");break;case"info":t.message&&eM(t.message,"system")}}catch(e){}}if(y&&"complete"===y.type){let t={success:!0,results:y.results,explanation:y.explanation,structure:y.structure,message:y.message};if(t.success){let{results:a}=t;if((null==(n=a.packagesInstalled)?void 0:n.length)>0&&eK("Packages installed: ".concat(a.packagesInstalled.join(", "))),(null==(r=a.filesCreated)?void 0:r.length)>0&&(eK("Files created:"),a.filesCreated.forEach(e=>{eK("  ".concat(e),"command")}),(null==e?void 0:e.sandboxId)&&a.filesCreated.length>0&&setTimeout(()=>{eS.current&&(eS.current.src=eS.current.src)},1e3)),(null==(o=a.filesUpdated)?void 0:o.length)>0&&(eK("Files updated:"),a.filesUpdated.forEach(e=>{eK("  ".concat(e),"command")})),eE(e=>({...e,appliedCode:[...e.appliedCode,{files:[...a.filesCreated||[],...a.filesUpdated||[]],timestamp:new Date}]})),(null==(c=a.commandsExecuted)?void 0:c.length)>0&&(eK("Commands executed:"),a.commandsExecuted.forEach(e=>{eK("  $ ".concat(e),"command")})),(null==(d=a.errors)?void 0:d.length)>0&&a.errors.forEach(e=>{eK(e,"error")}),t.structure&&eD(t.structure),t.explanation&&eK(t.explanation),eK("Code applied successfully!"),console.log("[applyGeneratedCode] Response data:",t),console.log("[applyGeneratedCode] Debug info:","debug info removed"),console.log("[applyGeneratedCode] Current sandboxData:",e),console.log("[applyGeneratedCode] Current iframe element:",eS.current),console.log("[applyGeneratedCode] Current iframe src:",null==(p=eS.current)?void 0:p.src),(null==(m=a.filesCreated)?void 0:m.length)>0){eE(e=>({...e,appliedCode:[...e.appliedCode,{files:a.filesCreated,timestamp:new Date}]})),s?eM("Edit applied successfully!","system"):_.slice(-5).some(e=>e.content.includes("AI recreation generated")||e.content.includes("Code generated"))?eM("Applied ".concat(a.filesCreated.length," files successfully!"),"system"):eM("Applied ".concat(a.filesCreated.length," files successfully!"),"system",{appliedFiles:a.filesCreated}),(null==(x=a.packagesFailed)?void 0:x.length)>0&&eM("⚠️ Some packages failed to install. Check the error banner above for details.","system"),await eB(),await eO(),console.log("[build-test] Skipping build test - would need API endpoint");let t=i.codeApplication.defaultRefreshDelay;setTimeout(()=>{if(eS.current&&(null==e?void 0:e.url)){console.log("[home] Refreshing iframe after code application...");let t="".concat(e.url,"?t=").concat(Date.now(),"&applied=true");eS.current.src=t,setTimeout(()=>{try{var e;(null==(e=eS.current)?void 0:e.contentWindow)&&(eS.current.contentWindow.location.reload(),console.log("[home] Force reloaded iframe content"))}catch(e){console.log("[home] Could not reload iframe (cross-origin):",e)}},1e3)}},t)}if(eS.current&&(null==e?void 0:e.url)){let s=(null==a||null==(u=a.packagesInstalled)?void 0:u.length)>0||(null==(g=t.results)||null==(h=g.packagesInstalled)?void 0:h.length)>0,n=s?i.codeApplication.packageInstallRefreshDelay:i.codeApplication.defaultRefreshDelay;console.log("[applyGeneratedCode] Packages installed: ".concat(s,", refresh delay: ").concat(n,"ms")),setTimeout(async()=>{if(eS.current&&(null==e?void 0:e.url)){console.log("[applyGeneratedCode] Starting iframe refresh sequence..."),console.log("[applyGeneratedCode] Current iframe src:",eS.current.src),console.log("[applyGeneratedCode] Sandbox URL:",e.url);try{let s="".concat(e.url,"?t=").concat(Date.now(),"&force=true");console.log("[applyGeneratedCode] Attempting direct navigation to:",s),eS.current.onload=null,eS.current.src=s,await new Promise(e=>setTimeout(e,2e3));try{var t;let e=eS.current.contentDocument||(null==(t=eS.current.contentWindow)?void 0:t.document);if(e&&"complete"===e.readyState)return void console.log("[applyGeneratedCode] Iframe loaded successfully")}catch(e){console.log("[applyGeneratedCode] Cannot access iframe content (CORS), assuming loaded");return}}catch(e){console.error("[applyGeneratedCode] Direct navigation failed:",e)}console.log("[applyGeneratedCode] Falling back to iframe recreation...");let s=eS.current.parentElement,a=document.createElement("iframe");a.className=eS.current.className,a.title=eS.current.title,a.allow=eS.current.allow;let n=eS.current.getAttribute("sandbox");n&&a.setAttribute("sandbox",n),eS.current.remove(),a.src="".concat(e.url,"?t=").concat(Date.now(),"&recreated=true"),null==s||s.appendChild(a),eS.current=a,console.log("[applyGeneratedCode] Iframe recreated with new content")}else console.error("[applyGeneratedCode] No iframe or sandbox URL available for refresh")},n)}}else throw Error((null==y?void 0:y.error)||"Failed to apply code")}else eM("Code application may have partially succeeded. Check the preview.","system")}catch(e){eK("Failed to apply code: ".concat(e.message),"error")}finally{l(!1),eG(e=>({...e,isEdit:!1}))}},eB=async()=>{if(e)try{let e=await fetch("/api/get-sandbox-files",{method:"GET",headers:{"Content-Type":"application/json"}});if(e.ok){let t=await e.json();t.success&&(ej(t.files||{}),ek(t.structure||""),console.log("[fetchSandboxFiles] Updated file list:",Object.keys(t.files||{}).length,"files"))}}catch(e){console.error("[fetchSandboxFiles] Error fetching files:",e)}},eU=async()=>{let t=I.trim();if(!t)return;if(!S)return void eM("AI is disabled. Please enable it first.","system");eM(t,"user"),E("");let s=t.toLowerCase().trim();if("check packages"===s||"install packages"===s||"npm install"===s)return e?void await eO():void eM("No active sandbox. Create a sandbox first!","system");let a=null,n=!1;e||(n=!0,eM("Creating sandbox while I plan your app...","system"),a=ez(!0).catch(e=>{throw eM("Failed to create sandbox: ".concat(e.message),"system"),e}));let r=eI.appliedCode.length>0;try{var i;eG(e=>({...e,isGenerating:!0,status:"Starting AI generation...",components:[],currentComponent:0,streamedCode:"",isStreaming:!1,isThinking:!0,thinkingText:"Analyzing your request...",thinkingDuration:void 0,currentFile:void 0,lastProcessedPosition:0,isEdit:r,files:e.files})),console.log("[chat] Using backend file cache for context");let s={sandboxId:(null==e?void 0:e.sandboxId)||(n?"pending":null),structure:m,recentMessages:_.slice(-20),conversationContext:eI,currentCode:N,sandboxUrl:null==e?void 0:e.url,sandboxCreating:n};console.log("[chat] Sending context to AI:"),console.log("[chat] - sandboxId:",s.sandboxId),console.log("[chat] - isEdit:",eI.appliedCode.length>0);let l=await fetch("/api/generate-ai-code-stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:t,model:A,context:s,isEdit:eI.appliedCode.length>0})});if(!l.ok)throw Error("HTTP error! status: ".concat(l.status));let o=null==(i=l.body)?void 0:i.getReader(),c=new TextDecoder,d="",p="";if(o)for(;;){let{done:e,value:t}=await o.read();if(e)break;for(let e of c.decode(t).split("\n"))if(e.startsWith("data: "))try{let t=JSON.parse(e.slice(6));if("status"===t.type)eG(e=>({...e,status:t.message}));else if("thinking"===t.type)eG(e=>({...e,isThinking:!0,thinkingText:(e.thinkingText||"")+t.text}));else if("thinking_complete"===t.type)eG(e=>({...e,isThinking:!1,thinkingDuration:t.duration}));else if("conversation"===t.type){let e=t.text||"";(e=(e=e.replace(/<package>[^<]*<\/package>/g,"")).replace(/<packages>[^<]*<\/packages>/g,"")).includes("<file")||e.includes("import React")||e.includes("export default")||e.includes("className=")||!(e.trim().length>0)||eM(e.trim(),"ai")}else if("stream"===t.type&&t.raw)eG(e=>{let s,a=e.streamedCode+t.text,n={...e,streamedCode:a,isStreaming:!0,isThinking:!1,status:"Generating code..."},r=/<file path="([^"]+)">([^]*?)<\/file>/g,i=new Set(e.files.map(e=>e.path));for(;null!==(s=r.exec(a));){let t=s[1],a=s[2];if(!i.has(t)){let s=t.split(".").pop()||"",r="jsx"===s||"js"===s?"javascript":"css"===s?"css":"json"===s?"json":"html"===s?"html":"text",l=n.files.findIndex(e=>e.path===t);l>=0?n.files=[...n.files.slice(0,l),{...n.files[l],content:a.trim(),type:r,completed:!0},...n.files.slice(l+1)]:n.files=[...n.files,{path:t,content:a.trim(),type:r,completed:!0}],e.isEdit||(n.status="Completed ".concat(t)),i.add(t)}}let l=a.match(/<file path="([^"]+)">([^]*?)$/);if(l&&!l[0].includes("</file>")){let t=l[1],s=l[2];if(!i.has(t)){let a=t.split(".").pop()||"",r="jsx"===a||"js"===a?"javascript":"css"===a?"css":"json"===a?"json":"html"===a?"html":"text";n.currentFile={path:t,content:s,type:r},e.isEdit||(n.status="Generating ".concat(t))}}else n.currentFile=void 0;return n});else if("app"===t.type)eG(e=>({...e,status:"Generated App.jsx structure"}));else if("component"===t.type)eG(e=>({...e,status:"Generated ".concat(t.name),components:[...e.components,{name:t.name,path:t.path,completed:!0}],currentComponent:t.index}));else if("package"===t.type)eG(e=>({...e,status:t.message||"Installing ".concat(t.name)}));else if("complete"===t.type){let e;d=t.generatedCode,p=t.explanation,eE(e=>({...e,lastGeneratedCode:d})),eG(e=>({...e,isThinking:!1,thinkingText:void 0,thinkingDuration:void 0})),t.packagesToInstall&&t.packagesToInstall.length>0&&(console.log("[generate-code] Packages to install from tools:",t.packagesToInstall),window.pendingPackages=t.packagesToInstall);let s=/<file path="([^"]+)">([^]*?)<\/file>/g,a=[];for(;null!==(e=s.exec(t.generatedCode));){let t=e[1],s=e[2],n=t.split(".").pop()||"",r="jsx"===n||"js"===n?"javascript":"css"===n?"css":"json"===n?"json":"html"===n?"html":"text";a.push({path:t,content:s.trim(),type:r,completed:!0})}eG(e=>({...e,status:"Generated ".concat(a.length>0?a.length:e.files.length," file").concat((a.length>0?a.length:e.files.length)!==1?"s":"","!"),isGenerating:!1,isStreaming:!1,isEdit:e.isEdit,files:e.files.length>0?e.files:a}))}else if("error"===t.type)throw Error(t.error)}catch(e){console.error("Failed to parse SSE data:",e)}}if(d){let t,s=/<file path="([^"]+)">([^]*?)<\/file>/g,n=[];for(;null!==(t=s.exec(d));)n.push(t[1]);if(r&&n.length>0){let e=n.map(e=>e.split("/").pop()).join(", ");eM(p||"Updated ".concat(e),"ai",{appliedFiles:[n[0]]})}else eM(p||"Code generated!","ai",{appliedFiles:n});if(k(d),a){eM("Waiting for sandbox to be ready...","system");try{await a,C(e=>e.filter(e=>"Waiting for sandbox to be ready..."!==e.content))}catch(e){eM("Sandbox creation failed. Cannot apply code.","system");return}}e&&d&&await eY(d,r)}eG(e=>({...e,isGenerating:!1,isStreaming:!1,status:"Generation complete!",isEdit:e.isEdit,isThinking:!1,thinkingText:void 0,thinkingDuration:void 0})),setTimeout(()=>{es("preview")},1e3)}catch(e){C(e=>e.filter(e=>"Thinking..."!==e.content)),eM("Error: ".concat(e.message),"system"),eG({isGenerating:!1,status:"",components:[],currentComponent:0,streamedCode:"",isStreaming:!1,isThinking:!1,thinkingText:void 0,thinkingDuration:void 0,files:[],currentFile:void 0,lastProcessedPosition:0}),es("preview")}},eH=async()=>{if(!e)return void eM("No active sandbox to download. Create a sandbox first!","system");l(!0),eK("Creating zip file..."),eM("Creating ZIP file of your Vite app...","system");try{let e=await fetch("/api/create-zip",{method:"POST",headers:{"Content-Type":"application/json"}}),t=await e.json();if(t.success){eK("Zip file created!"),eM("ZIP file created! Download starting...","system");let e=document.createElement("a");e.href=t.dataUrl,e.download=t.fileName||"e2b-project.zip",document.body.appendChild(e),e.click(),document.body.removeChild(e),eM("Your Vite app has been downloaded! To run it locally:\n1. Unzip the file\n2. Run: npm install\n3. Run: npm run dev\n4. Open http://localhost:5173","system")}else throw Error(t.error)}catch(e){eK("Failed to create zip: ".concat(e.message),"error"),eM("Failed to create ZIP: ".concat(e.message),"system")}finally{l(!1)}},eJ=async()=>{if(!eI.lastGeneratedCode)return void eM("No previous generation to re-apply","system");if(!e)return void eM("Please create a sandbox first","system");eM("Re-applying last generation...","system");let t=eI.appliedCode.length>0;await eY(eI.lastGeneratedCode,t)};(0,n.useEffect)(()=>{eA.current&&eT.isStreaming&&(eA.current.scrollTop=eA.current.scrollHeight)},[eT.streamedCode,eT.isStreaming]);let eq=e=>{let t=new Set(U);t.has(e)?t.delete(e):t.add(e),H(t)},eQ=async e=>{q(e)},eV=e=>{var t;let s=null==(t=e.split(".").pop())?void 0:t.toLowerCase();return"jsx"===s||"js"===s?(0,a.jsx)(v.AeH,{className:"w-4 h-4 text-yellow-500"}):"tsx"===s||"ts"===s?(0,a.jsx)(v.GWR,{className:"w-4 h-4 text-blue-500"}):"css"===s?(0,a.jsx)(v.jrh,{className:"w-4 h-4 text-blue-500"}):"json"===s?(0,a.jsx)(v.zUx,{className:"w-4 h-4 text-gray-600"}):(0,a.jsx)(b.QuH,{className:"w-4 h-4 text-gray-600"})},eZ=async e=>{em(!0),eu(null);try{let t=await fetch("/api/scrape-screenshot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e})}),s=await t.json();if(s.success&&s.screenshot){ed(s.screenshot),eg(!0);let t=e.replace(/^https?:\/\//i,"");eb(t),"preview"!==et&&es("preview")}else eu(s.error||"Failed to capture screenshot")}catch(e){console.error("Failed to capture screenshot:",e),eu("Network error while capturing screenshot")}finally{em(!1)}},e$=async t=>{if(t.preventDefault(),!Z.trim())return;V(!0),C([]);let s=Z.trim();s.match(/^https?:\/\//i)||(s="https://"+s);let a=s.replace(/^https?:\/\//i,"");eM("Starting to clone ".concat(a,"..."),"system");let n=e?Promise.resolve():ez(!0);e||eZ(s),ey("gathering"),es("preview"),setTimeout(async()=>{B(!1),V(!1),await n,W(Z),M(!1),D(["Scraping website content..."]);try{let t=Z.trim();t.match(/^https?:\/\//i)||(t="https://"+t);let s=await fetch("/api/scrape-url-enhanced",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:t})});if(!s.ok)throw Error("Failed to scrape website");let a=await s.json();if(!a.success)throw Error(a.error||"Failed to scrape website");D(["Website scraped successfully!","Generating React app..."]),eg(!1),ed(null),eb(""),ey("planning"),setTimeout(()=>{ey("generating"),es("generation")},1500),eE(e=>({...e,scrapedWebsites:[...e.scrapedWebsites,{url:t,content:a,timestamp:new Date}],currentProject:"".concat(t," Clone")}));let n="I want to recreate the ".concat(t," website as a complete React application based on the scraped content below.\n\n").concat(JSON.stringify(a,null,2),"\n\n").concat(X?"ADDITIONAL CONTEXT/REQUIREMENTS FROM USER:\n".concat(X,"\n\nPlease incorporate these requirements into the design and implementation."):"","\n\nIMPORTANT INSTRUCTIONS:\n- Create a COMPLETE, working React application\n- Implement ALL sections and features from the original site\n- Use Tailwind CSS for all styling (no custom CSS files)\n- Make it responsive and modern\n- Ensure all text content matches the original\n- Create proper component structure\n- Make sure the app actually renders visible content\n- Create ALL components that you reference in imports\n").concat(X?"- Apply the user's context/theme requirements throughout the application":"","\n\nFocus on the key sections and content, making it clean and modern.");eG(e=>({isGenerating:!0,status:"Initializing AI...",components:[],currentComponent:0,streamedCode:"",isStreaming:!0,isThinking:!1,thinkingText:void 0,thinkingDuration:void 0,files:e.files||[],currentFile:void 0,lastProcessedPosition:0}));let r=await fetch("/api/generate-ai-code-stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:n,model:A,context:{sandboxId:null==e?void 0:e.sandboxId,structure:m,conversationContext:eI}})});if(!r.ok||!r.body)throw Error("Failed to generate code");let i=r.body.getReader(),l=new TextDecoder,o="",c="";for(;;){let{done:e,value:t}=await i.read();if(e)break;for(let e of l.decode(t).split("\n"))if(e.startsWith("data: "))try{let t=JSON.parse(e.slice(6));if("status"===t.type)eG(e=>({...e,status:t.message}));else if("thinking"===t.type)eG(e=>({...e,isThinking:!0,thinkingText:(e.thinkingText||"")+t.text}));else if("thinking_complete"===t.type)eG(e=>({...e,isThinking:!1,thinkingDuration:t.duration}));else if("conversation"===t.type){let e=t.text||"";(e=(e=e.replace(/<package>[^<]*<\/package>/g,"")).replace(/<packages>[^<]*<\/packages>/g,"")).includes("<file")||e.includes("import React")||e.includes("export default")||e.includes("className=")||!(e.trim().length>0)||eM(e.trim(),"ai")}else"stream"===t.type&&t.raw?eG(e=>{let s,a=e.streamedCode+t.text,n={...e,streamedCode:a,isStreaming:!0,isThinking:!1,status:"Generating code..."},r=/<file path="([^"]+)">([^]*?)<\/file>/g,i=new Set(e.files.map(e=>e.path));for(;null!==(s=r.exec(a));){let t=s[1],a=s[2];if(!i.has(t)){let s=t.split(".").pop()||"",r="jsx"===s||"js"===s?"javascript":"css"===s?"css":"json"===s?"json":"html"===s?"html":"text",l=n.files.findIndex(e=>e.path===t);l>=0?n.files=[...n.files.slice(0,l),{...n.files[l],content:a.trim(),type:r,completed:!0},...n.files.slice(l+1)]:n.files=[...n.files,{path:t,content:a.trim(),type:r,completed:!0}],e.isEdit||(n.status="Completed ".concat(t)),i.add(t)}}let l=a.match(/<file path="([^"]+)">([^]*?)$/);if(l&&!l[0].includes("</file>")){let t=l[1],s=l[2];if(!i.has(t)){let a=t.split(".").pop()||"",r="jsx"===a||"js"===a?"javascript":"css"===a?"css":"json"===a?"json":"html"===a?"html":"text";n.currentFile={path:t,content:s,type:r},e.isEdit||(n.status="Generating ".concat(t))}}else n.currentFile=void 0;return n}):"complete"===t.type&&(o=t.generatedCode,c=t.explanation,eE(e=>({...e,lastGeneratedCode:o})))}catch(e){console.error("Failed to parse SSE data:",e)}}if(eG(e=>({...e,isGenerating:!1,isStreaming:!1,status:"Generation complete!"})),o)eM("AI recreation generated!","system"),c&&c.trim()&&eM(c,"ai"),k(o),await eY(o,!1),eM("Successfully recreated ".concat(t," as a modern React app").concat(X?' with your requested context: "'.concat(X,'"'):"","! The scraped content is now in my context, so you can ask me to modify specific sections or add features based on the original site."),"ai",{scrapedUrl:t,scrapedContent:a,generatedCode:o}),eE(e=>({...e,generatedComponents:[],appliedCode:[...e.appliedCode,{files:[],timestamp:new Date}]}));else throw Error("Failed to generate recreation");W(""),D([]),ee(""),eG(e=>({...e,isGenerating:!1,isStreaming:!1,status:"Generation complete!"})),ed(null),eg(!1),eb(""),eu(null),ey(null),setTimeout(()=>{es("preview")},1e3)}catch(e){eM("Failed to clone website: ".concat(e.message),"system"),D([]),eg(!1),eG(e=>({...e,isGenerating:!1,isStreaming:!1,status:"",files:e.files}))}},500)};return(0,a.jsxs)("div",{className:"font-sans bg-background text-foreground h-screen flex flex-col",children:[Y&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 transition-opacity duration-500 ".concat(Q?"opacity-0":"opacity-100"),children:[(0,a.jsxs)("div",{className:"absolute inset-0 bg-white overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-gradient-radial from-orange-400/50 via-orange-300/30 to-transparent rounded-full blur-[80px] animate-[sunPulse_4s_ease-in-out_infinite]"}),(0,a.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[400px] h-[400px] bg-gradient-radial from-yellow-300/40 via-orange-400/30 to-transparent rounded-full blur-[40px] animate-[sunPulse_4s_ease-in-out_infinite_0.5s]"}),(0,a.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[1200px] h-[1200px] bg-gradient-radial from-orange-200/20 to-transparent rounded-full blur-[120px]"}),(0,a.jsx)("div",{className:"absolute bottom-0 left-1/2 w-[800px] h-[800px] animate-[orbShrink_3s_ease-out_forwards]",style:{transform:"translateX(-50%) translateY(45%)"},children:(0,a.jsxs)("div",{className:"relative w-full h-full",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-orange-600 rounded-full blur-[100px] opacity-30 animate-pulse"}),(0,a.jsx)("div",{className:"absolute inset-16 bg-orange-500 rounded-full blur-[80px] opacity-40 animate-pulse",style:{animationDelay:"0.3s"}}),(0,a.jsx)("div",{className:"absolute inset-32 bg-orange-400 rounded-full blur-[60px] opacity-50 animate-pulse",style:{animationDelay:"0.6s"}}),(0,a.jsx)("div",{className:"absolute inset-48 bg-yellow-300 rounded-full blur-[40px] opacity-60"})]})})]}),(0,a.jsx)("button",{onClick:()=>{V(!0),setTimeout(()=>{B(!1),V(!1)},500)},className:"absolute top-8 right-8 text-gray-500 hover:text-gray-700 transition-all duration-300 opacity-0 hover:opacity-100 bg-white/80 backdrop-blur-sm p-2 rounded-lg shadow-sm",style:{opacity:0},onMouseEnter:e=>e.currentTarget.style.opacity="0.8",onMouseLeave:e=>e.currentTarget.style.opacity="0",children:(0,a.jsx)("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,a.jsxs)("div",{className:"absolute top-0 left-0 right-0 z-20 px-6 py-4 flex items-center justify-between animate-[fadeIn_0.8s_ease-out]",children:[(0,a.jsx)("img",{src:"/firecrawl-logo-with-fire.webp",alt:"Firecrawl",className:"h-8 w-auto"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("button",{onClick:()=>eC(!0),className:"inline-flex items-center gap-2 bg-white/80 backdrop-blur-sm text-gray-700 px-3 py-2 rounded-[10px] text-sm font-medium border border-gray-200 hover:bg-white hover:border-gray-300 transition-all duration-200",title:"Settings",children:[(0,a.jsxs)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,a.jsx)("span",{children:"Settings"})]}),(0,a.jsxs)("a",{href:"https://github.com/mendableai/open-lovable",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 bg-[#36322F] text-white px-3 py-2 rounded-[10px] text-sm font-medium [box-shadow:inset_0px_-2px_0px_0px_#171310,_0px_1px_6px_0px_rgba(58,_33,_8,_58%)] hover:translate-y-[1px] hover:scale-[0.98] hover:[box-shadow:inset_0px_-1px_0px_0px_#171310,_0px_1px_3px_0px_rgba(58,_33,_8,_40%)] active:translate-y-[2px] active:scale-[0.97] active:[box-shadow:inset_0px_1px_1px_0px_#171310,_0px_1px_2px_0px_rgba(58,_33,_8,_30%)] transition-all duration-200",children:[(0,a.jsx)(b.BR8,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Use this template"})]})]})]}),(0,a.jsx)("div",{className:"relative z-10 h-full flex items-center justify-center px-4",children:(0,a.jsxs)("div",{className:"text-center max-w-4xl min-w-[600px] mx-auto",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("h1",{className:"text-[2.5rem] lg:text-[3.8rem] text-center text-[#36322F] font-semibold tracking-tight leading-[0.9] animate-[fadeIn_0.8s_ease-out]",children:[(0,a.jsx)("span",{className:"hidden md:inline",children:"Open Lovable"}),(0,a.jsx)("span",{className:"md:hidden",children:"Open Lovable"})]}),(0,a.jsx)(y.P.p,{className:"text-base lg:text-lg max-w-lg mx-auto mt-2.5 text-zinc-500 text-center text-balance",animate:{opacity:ea?.7:1},transition:{duration:.3,ease:"easeOut"},children:"Re-imagine any website, in seconds."})]}),(0,a.jsxs)("form",{onSubmit:e$,className:"mt-5 max-w-3xl mx-auto",children:[(0,a.jsxs)("div",{className:"w-full relative group",children:[(0,a.jsx)("input",{type:"text",value:Z,onChange:e=>{let t=e.target.value;$(t),/^(https?:\/\/)?(([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,})(\/?.*)?$/.test(t)&&t.length>5?setTimeout(()=>en(!0),100):(en(!1),ei(null))},placeholder:" ","aria-placeholder":"https://firecrawl.dev",className:"h-[3.25rem] w-full resize-none focus-visible:outline-none focus-visible:ring-orange-500 focus-visible:ring-2 rounded-[18px] text-sm text-[#36322F] px-4 pr-12 border-[.75px] border-border bg-white",style:{boxShadow:"0 0 0 1px #e3e1de66, 0 1px 2px #5f4a2e14, 0 4px 6px #5f4a2e0a, 0 40px 40px -24px #684b2514",filter:"drop-shadow(rgba(249, 224, 184, 0.3) -0.731317px -0.731317px 35.6517px)"},autoFocus:!0}),(0,a.jsx)("div",{"aria-hidden":"true",className:"absolute top-1/2 -translate-y-1/2 left-4 pointer-events-none text-sm text-opacity-50 text-start transition-opacity ".concat(Z?"opacity-0":"opacity-100"),children:(0,a.jsx)("span",{className:"text-[#605A57]/50",style:{fontFamily:"monospace"},children:"https://firecrawl.dev"})}),(0,a.jsx)("button",{type:"submit",disabled:!Z.trim(),className:"absolute top-1/2 transform -translate-y-1/2 right-2 flex h-10 items-center justify-center rounded-md px-3 text-sm font-medium text-zinc-500 hover:text-zinc-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-zinc-950 focus-visible:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:er?"Clone with ".concat(er," Style"):"Clone Website",children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:[(0,a.jsx)("polyline",{points:"9 10 4 15 9 20"}),(0,a.jsx)("path",{d:"M20 4v7a4 4 0 0 1-4 4H4"})]})})]}),ea&&(0,a.jsx)("div",{className:"overflow-hidden mt-4",children:(0,a.jsx)("div",{className:"transition-all duration-500 ease-out transform ".concat(ea?"translate-y-0 opacity-100":"-translate-y-4 opacity-0"),children:(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl p-4 shadow-sm",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3 font-medium",children:"How do you want your site to look?"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[{name:"Neobrutalist",description:"Bold colors, thick borders"},{name:"Glassmorphism",description:"Frosted glass effects"},{name:"Minimalist",description:"Clean and simple"},{name:"Dark Mode",description:"Dark theme"},{name:"Gradient",description:"Colorful gradients"},{name:"Retro",description:"80s/90s aesthetic"},{name:"Modern",description:"Contemporary design"},{name:"Monochrome",description:"Black and white"}].map(e=>(0,a.jsxs)("button",{type:"button",onKeyDown:e=>{if("Enter"===e.key){e.preventDefault(),e.stopPropagation();let t=e.currentTarget.closest("form");t&&t.requestSubmit()}},onClick:()=>{if(er===e.name)ei(null),ee(X.replace(/^[^,]+theme\s*,?\s*/,"").trim());else{ei(e.name);let t=X.replace(/^[^,]+theme\s*,?\s*/,"").trim();ee(e.name.toLowerCase()+" theme"+(t?", "+t:""))}},className:"p-3 rounded-lg border transition-all ".concat(er===e.name?"border-orange-400 bg-orange-50 text-gray-900 shadow-sm":"border-gray-200 bg-white hover:border-orange-200 hover:bg-orange-50/50 text-gray-700"),children:[(0,a.jsx)("div",{className:"text-sm font-medium",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:e.description})]},e.name))}),(0,a.jsx)("div",{className:"mt-4 mb-2",children:(0,a.jsx)("input",{type:"text",value:er?X.replace(RegExp("^"+er.toLowerCase()+" theme\\s*,?\\s*","i"),""):X,onChange:e=>{let t=e.target.value;er?ee(er.toLowerCase()+" theme"+(t.trim()?", "+t:"")):ee(t)},onKeyDown:e=>{if("Enter"===e.key){e.preventDefault();let t=e.currentTarget.closest("form");t&&t.requestSubmit()}},placeholder:"Add more details: specific features, color preferences...",className:"w-full px-4 py-2 text-sm bg-white border border-gray-200 rounded-lg text-gray-900 placeholder-gray-500 focus:outline-none focus:border-orange-300 focus:ring-2 focus:ring-orange-100 transition-all duration-200"})})]})})})]}),(0,a.jsx)("div",{className:"mt-6 flex items-center justify-center animate-[fadeIn_1s_ease-out]",children:(0,a.jsx)("select",{value:A,onChange:t=>{let s=t.target.value;L(s);let a=new URLSearchParams(window.location.search);a.set("model",s),(null==e?void 0:e.sandboxId)&&a.set("sandbox",e.sandboxId),P.push("/?".concat(a.toString()))},className:"px-3 py-1.5 text-sm bg-white border border-gray-300 rounded-[10px] focus:outline-none focus:ring-2 focus:ring-[#36322F] focus:border-transparent",style:{boxShadow:"0 0 0 1px #e3e1de66, 0 1px 2px #5f4a2e14"},children:i.ai.availableModels.map(e=>(0,a.jsx)("option",{value:e,children:i.ai.modelDisplayNames[e]||e},e))})})]})})]}),!T()&&(0,a.jsx)("div",{className:"bg-red-50 border-b border-red-200 px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"text-sm text-red-800 font-medium",children:"Required API keys are missing. Please configure your E2B and Firecrawl API keys in Settings."})]}),(0,a.jsx)(x,{variant:"outline",size:"sm",onClick:()=>eC(!0),className:"border-red-300 text-red-700 hover:bg-red-100",children:"Configure Now"})]})}),(0,a.jsxs)("div",{className:"bg-card px-4 py-4 border-b border-border flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center gap-4",children:(0,a.jsx)("img",{src:"/firecrawl-logo-with-fire.webp",alt:"Firecrawl",className:"h-8 w-auto"})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("select",{value:A,onChange:t=>{let s=t.target.value;L(s);let a=new URLSearchParams(window.location.search);a.set("model",s),(null==e?void 0:e.sandboxId)&&a.set("sandbox",e.sandboxId),P.push("/?".concat(a.toString()))},className:"px-3 py-1.5 text-sm bg-white border border-gray-300 rounded-[10px] focus:outline-none focus:ring-2 focus:ring-[#36322F] focus:border-transparent",children:i.ai.availableModels.map(e=>(0,a.jsx)("option",{value:e,children:i.ai.modelDisplayNames[e]||e},e))}),(0,a.jsx)(x,{variant:"default",onClick:()=>ez(),size:"sm",title:"Create new sandbox",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),(0,a.jsx)(x,{variant:"secondary",onClick:eJ,size:"sm",title:"Re-apply last generation",disabled:!eI.lastGeneratedCode||!e,children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),(0,a.jsx)(x,{variant:"outline",onClick:eH,disabled:!e,size:"sm",title:"Download your Vite app as ZIP",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})})}),(0,a.jsxs)(x,{variant:"outline",onClick:()=>eC(!0),size:"sm",title:"Settings",className:"relative ".concat(T()?"":"border-red-300 bg-red-50 hover:bg-red-100"),children:[(0,a.jsxs)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),!T()&&(0,a.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-pulse"})]}),(0,a.jsxs)("div",{className:"inline-flex items-center gap-2 bg-[#36322F] text-white px-3 py-1.5 rounded-[10px] text-sm font-medium [box-shadow:inset_0px_-2px_0px_0px_#171310,_0px_1px_6px_0px_rgba(58,_33,_8,_58%)]",children:[(0,a.jsx)("span",{id:"status-text",children:o.text}),(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(o.active?"bg-green-500":"bg-gray-500")})]})]})]}),(0,a.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex-1 max-w-[400px] flex flex-col border-r border-border bg-background",children:[eI.scrapedWebsites.length>0&&(0,a.jsx)("div",{className:"p-4 bg-card",children:(0,a.jsx)("div",{className:"flex flex-col gap-2",children:eI.scrapedWebsites.map((e,t)=>{var s;let n=(null==(s=e.content)?void 0:s.metadata)||{},r=n.sourceURL||e.url,i=n.favicon||"https://www.google.com/s2/favicons?domain=".concat(new URL(r).hostname,"&sz=32"),l=n.ogSiteName||n.title||new URL(r).hostname;return(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("img",{src:i,alt:l,className:"w-4 h-4 rounded",onError:e=>{e.currentTarget.src="https://www.google.com/s2/favicons?domain=".concat(new URL(r).hostname,"&sz=32")}}),(0,a.jsx)("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"text-black hover:text-gray-700 truncate max-w-[250px]",title:r,children:l})]},t)})})}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 flex flex-col gap-1 scrollbar-hide",ref:eP,children:[_.map((e,t)=>{var s,n,r,i,l,o,c;let d=e.content.includes("Successfully recreated")||e.content.includes("AI recreation generated!")||e.content.includes("Code generated!");return null==(s=e.metadata)||s.appliedFiles,(0,a.jsx)("div",{className:"block",children:(0,a.jsx)("div",{className:"flex ".concat("user"===e.type?"justify-end":"justify-start"," mb-1"),children:(0,a.jsxs)("div",{className:"block",children:[(0,a.jsx)("div",{className:"block rounded-[10px] px-4 py-2 ".concat("user"===e.type?"bg-[#36322F] text-white ml-auto max-w-[80%]":"ai"===e.type?"bg-gray-100 text-gray-900 mr-auto max-w-[80%]":"system"===e.type?"bg-[#36322F] text-white text-sm":"command"===e.type?"bg-[#36322F] text-white font-mono text-sm":"error"===e.type?"bg-red-900 text-red-100 text-sm border border-red-700":"bg-[#36322F] text-white text-sm"),children:"command"===e.type?(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-xs ".concat((null==(n=e.metadata)?void 0:n.commandType)==="input"?"text-blue-400":(null==(r=e.metadata)?void 0:r.commandType)==="error"?"text-red-400":(null==(i=e.metadata)?void 0:i.commandType)==="success"?"text-green-400":"text-gray-400"),children:(null==(l=e.metadata)?void 0:l.commandType)==="input"?"$":">"}),(0,a.jsx)("span",{className:"flex-1 whitespace-pre-wrap text-white",children:e.content})]}):"error"===e.type?(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-red-800 rounded-full flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-5 h-5 text-red-200",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-semibold mb-1",children:"Build Errors Detected"}),(0,a.jsx)("div",{className:"whitespace-pre-wrap text-sm",children:e.content}),(0,a.jsx)("div",{className:"mt-2 text-xs opacity-70",children:"Press 'F' or click the Fix button above to resolve"})]})]}):e.content}),(null==(o=e.metadata)?void 0:o.appliedFiles)&&e.metadata.appliedFiles.length>0&&(0,a.jsxs)("div",{className:"mt-2 inline-block bg-gray-100 rounded-[10px] p-3",children:[(0,a.jsx)("div",{className:"text-xs font-medium mb-1 text-gray-700",children:e.content.includes("Applied")?"Files Updated:":"Generated Files:"}),(0,a.jsx)("div",{className:"flex flex-wrap items-start gap-1",children:e.metadata.appliedFiles.map((e,t)=>{let s=e.split("/").pop()||e,n=s.split(".").pop()||"",r="jsx"===n||"js"===n?"javascript":"css"===n?"css":"json"===n?"json":"text";return(0,a.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-1 bg-[#36322F] text-white rounded-[10px] text-xs animate-fade-in-up",style:{animationDelay:"".concat(30*t,"ms")},children:[(0,a.jsx)("span",{className:"inline-block w-1.5 h-1.5 rounded-full ".concat("css"===r?"bg-blue-400":"javascript"===r?"bg-yellow-400":"json"===r?"bg-green-400":"bg-gray-400")}),s]},"applied-".concat(t))})})]}),d&&eT.files.length>0&&t===_.length-1&&!(null==(c=e.metadata)?void 0:c.appliedFiles)&&!_.some(e=>{var t;return null==(t=e.metadata)?void 0:t.appliedFiles})&&(0,a.jsxs)("div",{className:"mt-2 inline-block bg-gray-100 rounded-[10px] p-3",children:[(0,a.jsx)("div",{className:"text-xs font-medium mb-1 text-gray-700",children:"Generated Files:"}),(0,a.jsx)("div",{className:"flex flex-wrap items-start gap-1",children:eT.files.map((e,t)=>(0,a.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-1 bg-[#36322F] text-white rounded-[10px] text-xs animate-fade-in-up",style:{animationDelay:"".concat(30*t,"ms")},children:[(0,a.jsx)("span",{className:"inline-block w-1.5 h-1.5 rounded-full ".concat("css"===e.type?"bg-blue-400":"javascript"===e.type?"bg-yellow-400":"json"===e.type?"bg-green-400":"bg-gray-400")}),e.path.split("/").pop()]},"complete-".concat(t)))})]})]})})},t)}),eL.stage&&(0,a.jsx)(j,{state:eL}),eT.isGenerating&&(0,a.jsxs)("div",{className:"inline-block bg-gray-100 rounded-lg p-3",children:[(0,a.jsx)("div",{className:"text-sm font-medium mb-2 text-gray-700",children:eT.status}),(0,a.jsxs)("div",{className:"flex flex-wrap items-start gap-1",children:[eT.files.map((e,t)=>(0,a.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-1 bg-[#36322F] text-white rounded-[10px] text-xs animate-fade-in-up",style:{animationDelay:"".concat(30*t,"ms")},children:[(0,a.jsx)("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})}),e.path.split("/").pop()]},"file-".concat(t))),eT.currentFile&&(0,a.jsxs)("div",{className:"flex items-center gap-1 px-2 py-1 bg-[#36322F]/70 text-white rounded-[10px] text-xs animate-pulse",style:{animationDelay:"".concat(30*eT.files.length,"ms")},children:[(0,a.jsx)("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),eT.currentFile.path.split("/").pop()]})]}),eT.streamedCode&&(0,a.jsxs)(y.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"mt-3 border-t border-gray-300 pt-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"text-xs font-medium text-gray-600",children:"AI Response Stream"})]}),(0,a.jsx)("div",{className:"flex-1 h-px bg-gradient-to-r from-gray-300 to-transparent"})]}),(0,a.jsxs)("div",{className:"bg-gray-900 border border-gray-700 rounded max-h-32 overflow-y-auto scrollbar-hide",children:[(0,a.jsx)(h.A,{language:"jsx",style:g.A,customStyle:{margin:0,padding:"0.75rem",fontSize:"11px",lineHeight:"1.5",background:"transparent",maxHeight:"8rem",overflow:"hidden"},children:(()=>{let e=eT.streamedCode.slice(-1e3),t=e.indexOf("<");return -1!==t?e.slice(t):e})()}),(0,a.jsx)("span",{className:"inline-block w-2 h-3 bg-orange-400 ml-3 mb-3 animate-pulse"})]})]})]})]}),(0,a.jsx)("div",{className:"p-4 border-t border-border bg-card",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(u,{className:"min-h-[60px] pr-12 resize-y border-2 border-black focus:outline-none",placeholder:"",value:I,onChange:e=>E(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),eU())},rows:3}),(0,a.jsx)("button",{onClick:eU,className:"absolute right-2 bottom-2 p-2 bg-[#36322F] text-white rounded-[10px] hover:bg-[#4a4542] [box-shadow:inset_0px_-2px_0px_0px_#171310,_0px_1px_6px_0px_rgba(58,_33,_8,_58%)] hover:translate-y-[1px] hover:scale-[0.98] hover:[box-shadow:inset_0px_-1px_0px_0px_#171310,_0px_1px_3px_0px_rgba(58,_33,_8,_40%)] active:translate-y-[2px] active:scale-[0.97] active:[box-shadow:inset_0px_1px_1px_0px_#171310,_0px_1px_2px_0px_rgba(58,_33,_8,_30%)] transition-all duration-200",title:"Send message (Enter)",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})})]})})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,a.jsxs)("div",{className:"px-4 py-2 bg-card border-b border-border flex justify-between items-center",children:[(0,a.jsx)("div",{className:"flex items-center gap-4",children:(0,a.jsxs)("div",{className:"flex bg-[#36322F] rounded-lg p-1",children:[(0,a.jsx)("button",{onClick:()=>es("generation"),className:"p-2 rounded-md transition-all ".concat("generation"===et?"bg-black text-white":"text-gray-300 hover:text-white hover:bg-gray-700"),title:"Code",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})})}),(0,a.jsx)("button",{onClick:()=>es("preview"),className:"p-2 rounded-md transition-all ".concat("preview"===et?"bg-black text-white":"text-gray-300 hover:text-white hover:bg-gray-700"),title:"Preview",children:(0,a.jsxs)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})}),(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:["generation"===et&&(eT.isGenerating||eT.files.length>0)&&(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[!eT.isEdit&&(0,a.jsxs)("div",{className:"text-gray-600 text-sm",children:[eT.files.length," files generated"]}),(0,a.jsx)("div",{className:"inline-flex items-center justify-center whitespace-nowrap rounded-[10px] font-medium transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-[#36322F] text-white hover:bg-[#36322F] [box-shadow:inset_0px_-2px_0px_0px_#171310,_0px_1px_6px_0px_rgba(58,_33,_8,_58%)] hover:translate-y-[1px] hover:scale-[0.98] hover:[box-shadow:inset_0px_-1px_0px_0px_#171310,_0px_1px_3px_0px_rgba(58,_33,_8,_40%)] active:translate-y-[2px] active:scale-[0.97] active:[box-shadow:inset_0px_1px_1px_0px_#171310,_0px_1px_2px_0px_rgba(58,_33,_8,_30%)] disabled:shadow-none disabled:hover:translate-y-0 disabled:hover:scale-100 h-8 px-3 py-1 text-sm gap-2",children:eT.isGenerating?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse shadow-[0_0_10px_rgba(34,197,94,0.5)]"}),eT.isEdit?"Editing code":"Live code generation"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-gray-500 rounded-full"}),"COMPLETE"]})})]}),e&&!eT.isGenerating&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(x,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",title:"Open in new tab",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})})})})]})]}),(0,a.jsx)("div",{className:"flex-1 relative overflow-hidden",children:"generation"===et&&(eT.isGenerating||eT.files.length>0)?(0,a.jsxs)("div",{className:"absolute inset-0 flex overflow-hidden",children:[!eT.isEdit&&(0,a.jsxs)("div",{className:"w-[250px] border-r border-gray-200 bg-white flex flex-col flex-shrink-0",children:[(0,a.jsx)("div",{className:"p-3 bg-gray-100 text-gray-900 flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(f.Zl4,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Explorer"})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-2 scrollbar-hide",children:(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 py-1 px-2 hover:bg-gray-100 rounded cursor-pointer text-gray-700",onClick:()=>eq("app"),children:[U.has("app")?(0,a.jsx)(b.fK4,{className:"w-4 h-4 text-gray-600"}):(0,a.jsx)(b.fOo,{className:"w-4 h-4 text-gray-600"}),U.has("app")?(0,a.jsx)(f.KQM,{className:"w-4 h-4 text-blue-500"}):(0,a.jsx)(f.Zl4,{className:"w-4 h-4 text-blue-500"}),(0,a.jsx)("span",{className:"font-medium text-gray-800",children:"app"})]}),U.has("app")&&(0,a.jsx)("div",{className:"ml-4",children:(()=>{let e={};return eT.files.filter(e=>e.completed).map(e=>e.path),eT.files.forEach(t=>{let s=t.path.split("/"),a=s.length>1?s.slice(0,-1).join("/"):"",n=s[s.length-1];e[a]||(e[a]=[]),e[a].push({name:n,edited:t.completed||!1})}),Object.entries(e).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"mb-1",children:[t&&(0,a.jsxs)("div",{className:"flex items-center gap-1 py-1 px-2 hover:bg-gray-100 rounded cursor-pointer text-gray-700",onClick:()=>eq(t),children:[U.has(t)?(0,a.jsx)(b.fK4,{className:"w-4 h-4 text-gray-600"}):(0,a.jsx)(b.fOo,{className:"w-4 h-4 text-gray-600"}),U.has(t)?(0,a.jsx)(f.KQM,{className:"w-4 h-4 text-yellow-600"}):(0,a.jsx)(f.Zl4,{className:"w-4 h-4 text-yellow-600"}),(0,a.jsx)("span",{className:"text-gray-700",children:t.split("/").pop()})]}),(!t||U.has(t))&&(0,a.jsx)("div",{className:t?"ml-6":"",children:s.sort((e,t)=>e.name.localeCompare(t.name)).map(e=>{let s=t?"".concat(t,"/").concat(e.name):e.name,n=J===s;return(0,a.jsxs)("div",{className:"flex items-center gap-2 py-1 px-2 rounded cursor-pointer transition-all ".concat(n?"bg-blue-500 text-white":"text-gray-700 hover:bg-gray-100"),onClick:()=>eQ(s),children:[eV(e.name),(0,a.jsxs)("span",{className:"text-xs flex items-center gap-1 ".concat(n?"font-medium":""),children:[e.name,e.edited&&(0,a.jsx)("span",{className:"text-[10px] px-1 rounded ".concat(n?"bg-blue-400":"bg-orange-500 text-white"),children:"✓"})]})]},s)})})]},t)})})()})]})})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[eT.isGenerating&&(eT.isThinking||eT.thinkingText)&&(0,a.jsxs)("div",{className:"px-6 pb-6",children:[(0,a.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,a.jsx)("div",{className:"text-purple-600 font-medium flex items-center gap-2",children:eT.isThinking?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-purple-600 rounded-full animate-pulse"}),"AI is thinking..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"text-purple-600",children:"✓"}),"Thought for ",eT.thinkingDuration||0," seconds"]})})}),eT.thinkingText&&(0,a.jsx)("div",{className:"bg-purple-950 border border-purple-700 rounded-lg p-4 max-h-48 overflow-y-auto scrollbar-hide",children:(0,a.jsx)("pre",{className:"text-xs font-mono text-purple-300 whitespace-pre-wrap",children:eT.thinkingText})})]}),(0,a.jsx)("div",{className:"flex-1 rounded-lg p-6 flex flex-col min-h-0 overflow-hidden",children:(0,a.jsx)("div",{className:"flex-1 overflow-y-auto min-h-0 scrollbar-hide",ref:eA,children:J?(0,a.jsx)("div",{className:"animate-in fade-in slide-in-from-top-2 duration-300",children:(0,a.jsxs)("div",{className:"bg-black border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[(0,a.jsxs)("div",{className:"px-4 py-2 bg-[#36322F] text-white flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[eV(J),(0,a.jsx)("span",{className:"font-mono text-sm",children:J})]}),(0,a.jsx)("button",{onClick:()=>q(null),className:"hover:bg-black/20 p-1 rounded transition-colors",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsx)("div",{className:"bg-gray-900 border border-gray-700 rounded",children:(0,a.jsx)(h.A,{language:(()=>{var e;let t=null==(e=J.split(".").pop())?void 0:e.toLowerCase();return"css"===t?"css":"json"===t?"json":"html"===t?"html":"jsx"})(),style:g.A,customStyle:{margin:0,padding:"1rem",fontSize:"0.875rem",background:"transparent"},showLineNumbers:!0,children:(()=>{let e=eT.files.find(e=>e.path===J);return(null==e?void 0:e.content)||"// File content will appear here"})()})})]})}):0!==eT.files.length||eT.currentFile?(0,a.jsxs)("div",{className:"space-y-4",children:[eT.currentFile&&(0,a.jsxs)("div",{className:"bg-black border-2 border-gray-400 rounded-lg overflow-hidden shadow-sm",children:[(0,a.jsx)("div",{className:"px-4 py-2 bg-[#36322F] text-white flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("span",{className:"font-mono text-sm",children:eT.currentFile.path}),(0,a.jsx)("span",{className:"px-2 py-0.5 text-xs rounded ".concat("css"===eT.currentFile.type?"bg-blue-600 text-white":"javascript"===eT.currentFile.type?"bg-yellow-600 text-white":"json"===eT.currentFile.type?"bg-green-600 text-white":"bg-gray-200 text-gray-700"),children:"javascript"===eT.currentFile.type?"JSX":eT.currentFile.type.toUpperCase()})]})}),(0,a.jsxs)("div",{className:"bg-gray-900 border border-gray-700 rounded",children:[(0,a.jsx)(h.A,{language:"css"===eT.currentFile.type?"css":"json"===eT.currentFile.type?"json":"html"===eT.currentFile.type?"html":"jsx",style:g.A,customStyle:{margin:0,padding:"1rem",fontSize:"0.75rem",background:"transparent"},showLineNumbers:!0,children:eT.currentFile.content}),(0,a.jsx)("span",{className:"inline-block w-2 h-3 bg-orange-400 ml-4 mb-4 animate-pulse"})]})]}),eT.files.map((e,t)=>(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"px-4 py-2 bg-[#36322F] text-white flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-green-500",children:"✓"}),(0,a.jsx)("span",{className:"font-mono text-sm",children:e.path})]}),(0,a.jsx)("span",{className:"px-2 py-0.5 text-xs rounded ".concat("css"===e.type?"bg-blue-600 text-white":"javascript"===e.type?"bg-yellow-600 text-white":"json"===e.type?"bg-green-600 text-white":"bg-gray-200 text-gray-700"),children:"javascript"===e.type?"JSX":e.type.toUpperCase()})]}),(0,a.jsx)("div",{className:"bg-gray-900 border border-gray-700  max-h-48 overflow-y-auto scrollbar-hide",children:(0,a.jsx)(h.A,{language:"css"===e.type?"css":"json"===e.type?"json":"html"===e.type?"html":"jsx",style:g.A,customStyle:{margin:0,padding:"1rem",fontSize:"0.75rem",background:"transparent"},showLineNumbers:!0,wrapLongLines:!0,children:e.content})})]},t)),!eT.currentFile&&eT.streamedCode.length>0&&(0,a.jsxs)("div",{className:"bg-black border border-gray-200 rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"px-4 py-2 bg-[#36322F] text-white flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("span",{className:"font-mono text-sm",children:"Processing..."})]})}),(0,a.jsx)("div",{className:"bg-gray-900 border border-gray-700 rounded",children:(0,a.jsx)(h.A,{language:"jsx",style:g.A,customStyle:{margin:0,padding:"1rem",fontSize:"0.75rem",background:"transparent"},showLineNumbers:!1,children:(()=>{let e=eT.files.length>0?eT.streamedCode.lastIndexOf("</file>")+7:0,t=eT.streamedCode.slice(e).trim();return(t=t.replace(/<explanation>[\s\S]*?<\/explanation>/g,"").trim())||"Waiting for next file..."})()})})]})]}):eT.isThinking?(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"mb-8 relative",children:(0,a.jsxs)("div",{className:"w-24 h-24 mx-auto",children:[(0,a.jsx)("div",{className:"absolute inset-0 border-4 border-gray-800 rounded-full"}),(0,a.jsx)("div",{className:"absolute inset-0 border-4 border-green-500 rounded-full animate-spin border-t-transparent"})]})}),(0,a.jsx)("h3",{className:"text-xl font-medium text-white mb-2",children:"AI is analyzing your request"}),(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:eT.status||"Preparing to generate code..."})]})}):(0,a.jsxs)("div",{className:"bg-black border border-gray-200 rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"px-4 py-2 bg-gray-100 text-gray-900 flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("span",{className:"font-mono text-sm",children:"Streaming code..."})]})}),(0,a.jsxs)("div",{className:"p-4 bg-gray-900 rounded",children:[(0,a.jsx)(h.A,{language:"jsx",style:g.A,customStyle:{margin:0,padding:"1rem",fontSize:"0.875rem",background:"transparent"},showLineNumbers:!0,children:eT.streamedCode||"Starting code generation..."}),(0,a.jsx)("span",{className:"inline-block w-2 h-4 bg-orange-400 ml-1 animate-pulse"})]})]})})}),eT.components.length>0&&(0,a.jsx)("div",{className:"mx-6 mb-6",children:(0,a.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-gradient-to-r from-orange-500 to-orange-400 transition-all duration-300",style:{width:"".concat(eT.currentComponent/Math.max(eT.components.length,1)*100,"%")}})})})]})]}):"preview"===et?ec&&(s||eT.isGenerating||!(null==e?void 0:e.url)||eh)?(0,a.jsxs)("div",{className:"relative w-full h-full bg-gray-100",children:[(0,a.jsx)("img",{src:ec,alt:"Website preview",className:"w-full h-full object-contain"}),(eT.isGenerating||eh)&&(0,a.jsx)("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center bg-black/70 rounded-lg p-6 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-3 border-gray-300 border-t-white rounded-full animate-spin mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-white text-sm font-medium",children:eT.isGenerating?"Generating code...":"Preparing your design for ".concat(ef,"...")})]})})]}):ev||eT.isGenerating&&!eT.isEdit?(0,a.jsx)("div",{className:"relative w-full h-full bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsx)("div",{className:"w-16 h-16 border-4 border-orange-200 border-t-orange-500 rounded-full animate-spin mx-auto"})}),(0,a.jsxs)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:["gathering"===ev&&"Gathering website information...","planning"===ev&&"Planning your design...",("generating"===ev||eT.isGenerating)&&"Generating your application..."]}),(0,a.jsxs)("p",{className:"text-gray-600 text-sm",children:["gathering"===ev&&"Analyzing the website structure and content","planning"===ev&&"Creating the optimal React component architecture",("generating"===ev||eT.isGenerating)&&"Writing clean, modern code for your app"]})]})}):(null==e?void 0:e.url)&&!s?(0,a.jsxs)("div",{className:"relative w-full h-full",children:[(0,a.jsx)("iframe",{ref:eS,src:e.url,className:"w-full h-full border-none",title:"Open Lovable Sandbox",allow:"clipboard-write",sandbox:"allow-scripts allow-same-origin allow-forms allow-popups allow-modals"}),(0,a.jsx)("button",{onClick:()=>{if(eS.current&&(null==e?void 0:e.url)){console.log("[Manual Refresh] Forcing iframe reload...");let t="".concat(e.url,"?t=").concat(Date.now(),"&manual=true");eS.current.src=t}},className:"absolute bottom-4 right-4 bg-white/90 hover:bg-white text-gray-700 p-2 rounded-lg shadow-lg transition-all duration-200 hover:scale-105",title:"Refresh sandbox",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}):ep?(0,a.jsx)("div",{className:"flex items-center justify-center h-full bg-gray-900",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-3 border-gray-600 border-t-white rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-white",children:"Gathering website information"})]})}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full bg-gray-50 text-gray-600 text-lg",children:ex?(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"mb-2",children:"Failed to capture screenshot"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:ex})]}):e?(0,a.jsxs)("div",{className:"text-gray-500",children:[(0,a.jsx)("div",{className:"w-8 h-8 border-2 border-gray-300 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm",children:"Loading preview..."})]}):(0,a.jsx)("div",{className:"text-gray-500 text-center",children:(0,a.jsx)("p",{className:"text-sm",children:"Start chatting to create your first app"})})}):null})]})]}),(0,a.jsx)(G,{isOpen:e_,onClose:()=>eC(!1)}),(0,a.jsx)(R,{}),(0,a.jsx)(K,{})]})}}},e=>{e.O(0,[362,844,87,881,441,964,358],()=>e(e.s=19619)),_N_E=e.O()}]);