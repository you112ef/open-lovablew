name = "lovable-app"
compatibility_date = "2024-01-20"
compatibility_flags = ["nodejs_compat"]

[build]
command = "npm run build"
pages_build_output_dir = "out"

[env.production]
name = "lovable-app-production"

[env.staging]
name = "lovable-app-staging"

# Build settings
[build.upload]
format = "service-worker"

# Environment variables
[vars]
NODE_ENV = "production"
NEXT_PUBLIC_APP_NAME = "Lovable"
NEXT_PUBLIC_APP_VERSION = "2.0.0"

# AI API Keys (set these in Cloudflare Pages dashboard)
# OPENAI_API_KEY = "your_openai_api_key"
# ANTHROPIC_API_KEY = "your_anthropic_api_key"
# GROQ_API_KEY = "your_groq_api_key"

# Routes
[[routes]]
pattern = "/*"
script = "lovable-app"

# Headers for security and performance
[[headers]]
for = "/*"
[headers.values]
X-Frame-Options = "DENY"
X-Content-Type-Options = "nosniff"
Referrer-Policy = "strict-origin-when-cross-origin"
Permissions-Policy = "camera=(), microphone=(), geolocation=()"
X-XSS-Protection = "1; mode=block"
Strict-Transport-Security = "max-age=31536000; includeSubDomains"

# Cache static assets
[[headers]]
for = "/_next/static/*"
[headers.values]
Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/*.js"
[headers.values]
Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/*.css"
[headers.values]
Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/*.png"
[headers.values]
Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/*.jpg"
[headers.values]
Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/*.svg"
[headers.values]
Cache-Control = "public, max-age=31536000, immutable"